Refactoring del Workflow di Task Review e Re-planning (Revisione)

Obiettivo: Mantenere il processo di review esplicito per i task, ma migliorare la gestione del re-planning tramite la creazione di nuovi task per una migliore tracciabilità storica.

Dettagli delle Proposte:

1.  **Mantenimento del Workflow di Review Esplicito:**
    *   **Stato Attuale:** Un task in `needs_review` attende un'azione esplicita di "review" prima di passare ad altri stati.
    *   **Proposta:** Mantenere lo stato `needs_review` e la necessità di una transizione esplicita.
    *   **Transizioni da `needs_review`:**
        *   **A `ready`:** Se il task viene approvato in review e non necessita di ulteriori modifiche al piano. (Comportamento esistente).
        *   **A `replanned`:** Se il task viene rifiutato in review o si decide che il piano necessita di una revisione significativa che giustifichi la creazione di un nuovo task. (Nuovo comportamento, vedi punto 2).
    *   **Motivazione:** Garantire un controllo di qualità esplicito e un punto di decisione formale per il proseguimento del task.

2.  **Gestione del Re-planning tramite Nuovi Task:**
    *   **Stato Attuale:** Il re-planning di un task potrebbe sovrascrivere il piano esistente, rendendo difficile tracciare le iterazioni precedenti.
    *   **Proposta:** Quando un task necessita di un re-planning (in particolare, dopo essere stato rifiutato in review), non si modifica il task originale. Invece:
        *   Viene creato un **nuovo task** che rappresenta la nuova iterazione del piano.
        *   Il task originale viene marcato con un nuovo stato terminale `replanned`, indicando che il suo lavoro è stato continuato in un altro task.
        *   Il nuovo task avrà un riferimento al task originale (`parent_task_id` o `replaces_task_id`) per mantenere la tracciabilità.
    *   **Motivazione:**
        *   **Tracciabilità Chiara:** Ogni versione del piano e del suo stato è un'entità separata, facilitando l'auditing e la comprensione dell'evoluzione del lavoro.
        *   **Immutabilità del Piano:** Il piano di un task, una volta definito, rimane immutabile, garantendo l'integrità storica.
        *   **Coerenza con `aborted`:** Il task `replanned` si comporta in modo simile a un task `aborted` (terminale), ma con un significato specifico di "continuato altrove".

Implicazioni Tecniche:

*   **Modifiche agli Stati dei Task:** Aggiungere un nuovo stato `replanned` all'enum degli stati dei task.
*   **Modifiche all'API `review`:** L'API di review dovrà supportare la transizione a `ready` o a `replanned`. Se transita a `replanned`, dovrà anche facilitare la creazione del nuovo task collegato.
*   **Modifiche all'API `define_plan`:** L'API `define_plan` non modificherà più un task esistente se questo è in uno stato che richiede un re-plan (es. `needs_review` con rifiuto), ma indirizzerà l'utente a creare un nuovo task.
*   **Interfaccia Utente/CLI:** Aggiornare la CLI per guidare l'utente nelle transizioni da `needs_review` e per visualizzare chiaramente i collegamenti tra task `replanned` e i loro successori.

Prossimi Passi:

1.  Attendere l'approvazione di questo piano rivisto.
2.  Se approvato, procedere con l'implementazione delle modifiche agli stati e alle API dei task.