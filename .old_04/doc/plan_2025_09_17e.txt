# Plan for Enhanced Logging (Console and File with Levels)

This plan outlines the steps to enhance the logging system to output to both console and a file, with support for different logging levels.

## 1. Configure `tracing-subscriber` for Multiple Outputs

- **Action:** Modify `src/main.rs`.
- **Details:**
    - Add `tracing-appender` dependency to `Cargo.toml`.
    - Configure `tracing-subscriber` to use `fmt()` for console output and `tracing_appender::rolling::daily()` for file output (`vespe.log`).
    - Combine these using `tracing_subscriber::layer::Layer` and `tracing_subscriber::filter::EnvFilter`.
    - Set initial log level to `info` for both outputs.

## 2. Remove Custom Logger

- **Action:** Delete the file `src/logging.rs`.
- **Action:** Remove `pub mod logging;` from `src/lib.rs`.
- **Details:** The custom `Logger` struct will be replaced by the `tracing` framework.

## 3. Update Log Calls

- **Action:** Replace custom `logger.log_*` calls with `tracing` macros.
- **Details:**
    - In `src/llm/llm_client.rs`:
        - Remove `use crate::logging::Logger;`.
        - Modify `generate_response` function signature to remove `logger: &mut Logger`.
        - Replace `logger.log_llm_query(&messages);` with `info!("LLM Query:\n{:#?}", messages);
`.
        - Replace `logger.log_llm_response(&response_content);` with `info!("LLM Response:\n{}", response_content);
`.
    - In `src/tools/tool_registry.rs`:
        - Remove `use crate::logging::Logger;`.
        - Modify `execute_tool` function signature to remove `logger: &mut Logger`.
        - Replace `logger.log_tool_call(tool_name, input);` with `info!("Tool Call: {}({:#?})", tool_name, input);
`.
        - Replace `logger.log_tool_return(tool_name, &output);` with `info!("Tool Return [{}]:\n{:#?}", tool_name, output);
`.
    - In `src/agent/impls/basic_agent.rs`:
        - Remove `use crate::logging::Logger;`.
        - Remove `let mut logger = Logger::new("vespe.log");`.
        - Modify `_handle_tool_calls` function signature to remove `logger: &mut Logger`.
        - Modify `generate_response` and `execute_tool` calls to remove `&mut logger` parameter.

## 4. Verification

- **Action:** Build the project using `cargo build`.
- **Action:** Run the application using the `chat` command.
- **Verification:** Check console output and `vespe.log` file for correct log messages at the "info" level.
- **Verification:** Ensure the application still functions correctly.
