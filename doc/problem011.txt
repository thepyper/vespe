c:\Proj\xxx\025_006.Vespe\vespe\buzz\training>python train.py
Loading dataset...
Generating train split: 203 examples [00:00, 11059.58 examples/s]

Dataset loaded and split:
DatasetDict({
    train: Dataset({
        features: ['full_text', 'spans'],
        num_rows: 182
    })
    test: Dataset({
        features: ['full_text', 'spans'],
        num_rows: 21
    })
})

Tokenizing and aligning labels with new span-based method...
Map:   0%|                                                                              | 0/182 [00:00<?, ? examples/s]
Traceback (most recent call last):
  File "c:\Proj\xxx\025_006.Vespe\vespe\buzz\training\train.py", line 162, in <module>
    main()
  File "c:\Proj\xxx\025_006.Vespe\vespe\buzz\training\train.py", line 90, in main
    tokenized_datasets = raw_datasets.map(tokenize_and_align_labels, batched=True)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\dataset_dict.py", line 954, in map
    dataset_dict[split] = dataset.map(
                          ^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\arrow_dataset.py", line 562, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\arrow_dataset.py", line 3327, in map
    for rank, done, content in Dataset._map_single(**unprocessed_kwargs):
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\arrow_dataset.py", line 3683, in _map_single
    for i, batch in iter_outputs(shard_iterable):
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\arrow_dataset.py", line 3633, in iter_outputs
    yield i, apply_function(example, i, offset=offset)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\thepy\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\datasets\arrow_dataset.py", line 3556, in apply_function
    processed_inputs = function(*fn_args, *additional_args, **fn_kwargs)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Proj\xxx\025_006.Vespe\vespe\buzz\training\train.py", line 74, in tokenize_and_align_labels
    doc_labels[token_start_index] = label2id[f"B-{span_label}"]
                                    ~~~~~~~~^^^^^^^^^^^^^^^^^^^
KeyError: 'B-TOOL_CALL'
