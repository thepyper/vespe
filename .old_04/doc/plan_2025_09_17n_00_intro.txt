# Piano Dettagliato di Refactoring per le Markdown Policies

Questo piano descrive la refactoring delle Markdown Policies nel progetto "vespe", con un focus sulla separazione delle responsabilità, sulla gestione flessibile della formattazione dell'output dei tool e sull'introduzione di `enum` per migliorare la robustezza del codice.

## Obiettivo

Separare le tre Markdown Policies (`JsonPolicy`, `XmlPolicy`, `SectionsPolicy`) in file distinti, migliorando la manutenibilità e la scalabilità. Un obiettivo chiave è spostare la logica di formattazione specifica dell'output dei tool fuori dalle implementazioni delle policy, centralizzandola in un modulo dedicato che possa adattarsi al `PolicyType` corrente. Inoltre, introdurremo un `ToolType` enum per eliminare le stringhe hardcoded e migliorare la sicurezza dei tipi.

## Fasi del Piano

Il piano è diviso in quattro fasi principali:
1.  **Fase 0: Preparazione degli Enum**: Creazione degli enum `PolicyType` e `ToolType` e aggiornamento dei moduli.
2.  **Fase 1: Refactoring della Gestione dell'Output dei Tool**: Creazione di un modulo per la formattazione specifica dell'output dei tool e adattamento delle policy per utilizzarlo.
3.  **Fase 2: Separazione dei File delle Policy**: Creazione dei file separati per ciascuna policy e pulizia del file originale.
4.  **Fase 3: Integrazione e Verifica**: Aggiornamento dei riferimenti nel codice e verifica della compilazione.

---

**CONTINUA NEL FILE: `doc/plan_2025_09_17n_01_phase0_policy_types.txt`**