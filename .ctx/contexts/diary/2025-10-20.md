@include rules
@include project
@include agent/planner

facciamo piccoli refactor, SENZA CAMBIARE NULLA NEL FUNZIONAMENTO CHE VA BENISSIMO, al modulo src/ast2

abbiamo scomposto src/ast2/ in sottomoduli, prima era un unico modulo.
il prossimo refactoring che voglio e' rendere la api privata, tranne poche 
cose che servono all'esterno del modulo, ovvero:
1) parse_document
2) tutti i tipi di dato della AST ritornata da parse_document

nel fare l'intervento, dovrai fare in modo che molte cose rimangano pubbliche all'interno del modulo ast2,
ma private all'esterno. per fare cio':

1) se devi fare delle impostazioni, continuassi ad usare path relativi, tipo super:: i super::super:: e non il nome
   assoluto del modulo ast2 che e' destinato a cambiare.
2) fai un intervento minimale se possibile, tipo non so, si puo' fare un "internal.rs" che re-esporta tutta la api necessaria internamente al modulo
   e poi si importa solo quello? comunque credo dovrai cambiare la visibilita' di molte funzioni a pub(crate)? o pub(super)?
fai un piano poi decidiamo come agire.

<!-- answer-cc0e440b-5f59-46cc-9c93-91749dc9176d:begin -->
Okay, I understand. I will create a plan to refactor the `src/ast2` module to restrict its external API, making most items private to the module while keeping them accessible internally. The `parse_document` function and the AST data types it returns will remain publicly accessible. I will ensure the changes are minimal, use relative paths for internal imports, and maintain existing functionality.

Here's my plan:

1.  **Analyze Current `src/ast2` Structure:**
    *   List all files and subdirectories within `src/ast2` to understand its current modular organization.
    *   Read `src/ast2/mod.rs` to identify how submodules are exposed and what items are currently public.
    *   Search for `pub fn` and `pub struct` declarations within the `src/ast2` directory to get a comprehensive list of currently public items.

2.  **Identify External Dependencies on `src/ast2`:**
    *   Search the entire project for `use crate::ast2::` or similar import statements to determine which parts of the codebase depend on `src/ast2` and what specific items they import. This will help identify the "public" items that need to remain public.

3.  **Determine Items to Remain Public:**
    *   Based on the analysis from steps 1 and 2, explicitly list `parse_document` and all AST data types that are returned by `parse_document` or are part of its public interface.

4.  **Refactor Visibility within `src/ast2`:**
    *   For all items (functions, structs, enums, traits) within `src/ast2` and its submodules that are *not* in the list from step 3, change their visibility from `pub` to `pub(crate)` or `pub(super)` as appropriate. The goal is to make them accessible within the `ast2` module but not outside it.
    *   Prioritize `pub(crate)` for items that need to be visible across the entire `ast2` crate, and `pub(super)` for items that only need to be visible to the parent module.
    *   Ensure that internal module imports continue to use relative paths (`super::`, `self::`).

5.  **Create an Internal Re-export Module (if necessary):**
    *   If many items need to be `pub(crate)` but are deeply nested, consider creating a new file like `src/ast2/internal.rs` that re-exports these items using `pub(crate) use ...;`. This can simplify internal imports within `ast2` and make the visibility management cleaner. This step will be evaluated after step 4.

6.  **Verify No Functional Changes:**
    *   Run the project's build and test commands to ensure that the visibility changes have not introduced any compilation errors or broken existing functionality.

7.  **Commit Changes:**
    *   Once verified, commit the changes with a descriptive message.

I will now proceed with step 1.
<!-- answer-cc0e440b-5f59-46cc-9c93-91749dc9176d:end -->