Refactoring Plan: Restructuring Vespe Crates

**Goal:** To establish a clearer separation of concerns within the Vespe project by making `vespe-project` the core library and moving the current CLI implementation into a dedicated `vespe-cli` crate. This will improve modularity, reusability, and maintainability.

**Current State:**
*   `vespe` (main crate): Contains `src/main.rs` (CLI entry point), `src/lib.rs`, and `src/bin/` executables.
*   `vespe-project`: A library crate containing core business logic, data models, and API.
*   `vespe-tui`: A new binary crate for the TUI frontend, currently depending on `vespe-project`.

**Desired State:**
*   `vespe` (main crate, renamed from `vespe-project`): The core library containing all business logic, data models, and API.
*   `vespe-cli`: A binary crate providing the command-line interface, depending on the new `vespe` core library.
*   `vespe-tui`: A binary crate providing the TUI frontend, depending on the new `vespe` core library.
*   `vespe-buzz`: Remains a separate crate.

**Phase 1: Create `vespe-cli` and Move Current `vespe` CLI Content**

1.  **Create `vespe-cli` Crate:**
    *   Execute: `cargo new vespe-cli --bin`
    *   This will create a new directory `vespe-cli/` with a basic `src/main.rs` and `Cargo.toml`.
    *   `cargo new` should automatically add `vespe-cli` to the workspace in the root `Cargo.toml`.

2.  **Move CLI Source Files:**
    *   Move `c:/Proj/xxx/025_006.Vespe/vespe/src/main.rs` to `c:/Proj/xxx/025_006.Vespe/vespe/vespe-cli/src/main.rs`.
    *   Move the directory `c:/Proj/xxx/025_006.Vespe/vespe/src/cli/` to `c:/Proj/xxx/025_006.Vespe/vespe/vespe-cli/src/cli/`.

3.  **Update `vespe-cli/Cargo.toml`:**
    *   Add dependencies required by the CLI: `clap`, `anyhow`, `vespe-project` (as a path dependency), `tokio`, `tracing`, `tracing-subscriber`, `chrono`, `uuid`, `serde`, `serde_json`, `thiserror`, `tempfile`, `walkdir`, `sha2`.
    *   Example dependency entry for `vespe-project`: `vespe-project = { path = "../vespe-project" }`

4.  **Update `vespe-cli/src/main.rs` Imports:**
    *   Adjust `use` statements to reflect the new crate structure. For example, `use vespe_project::api;` and `use crate::cli::commands;`.

5.  **Adjust Original `vespe` Crate:**
    *   Remove `src/main.rs` (it's been moved).
    *   Remove the `src/cli/` directory (it's been moved).
    *   Modify `c:/Proj/xxx/025_006.Vespe/vespe/Cargo.toml`:
        *   Remove the `[[bin]]` entry for `vespe` (the main CLI binary).
        *   Keep `[[bin]]` entries for `ollama_test_client`, `ollama_agent_client`, `data-generator`, `tool-format-tester`, `test_task_api` as they are currently part of the `vespe` crate's `src/bin` directory.
        *   The `vespe` crate will now primarily contain `src/lib.rs` and the `src/bin` executables.

**Phase 2: Make `vespe-project` the Core Library (Rename to `vespe`)**

1.  **Rename `vespe-project` Directory:**
    *   Rename `c:/Proj/xxx/025_006.Vespe/vespe/vespe-project/` to `c:/Proj/xxx/025_006.Vespe/vespe/vespe/`.

2.  **Update `Cargo.toml` in the Renamed Crate:**
    *   Modify `c:/Proj/xxx/025_006.Vespe/vespe/vespe/Cargo.toml`:
        *   Change `name = "vespe-project"` to `name = "vespe"`.

3.  **Update Root `Cargo.toml` Workspace Members:**
    *   Modify `c:/Proj/xxx/025_006.Vespe/vespe/Cargo.toml`:
        *   Change `"vespe-project"` to `"vespe"` in the `[workspace.members]` section.

4.  **Update Dependencies in Other Crates:**
    *   **`vespe-cli/Cargo.toml`:**
        *   Change `vespe-project = { path = "../vespe-project" }` to `vespe = { path = "../vespe" }`.
    *   **`vespe-tui/Cargo.toml`:**
        *   Change `vespe-project = { path = "../vespe-project" }` to `vespe = { path = "../vespe" }`.
    *   **`vespe-buzz/Cargo.toml` (if it depends on `vespe-project`):**
        *   Update its dependency path if necessary.

5.  **Update `use` statements in `vespe-cli` and `vespe-tui`:**
    *   Change `use vespe_project::...` to `use vespe::...` in all relevant files within `vespe-cli/src/` and `vespe-tui/src/`.

**Verification Steps (after each phase/major step):**
*   Run `cargo check --workspace` to ensure all crates compile.
*   Run `cargo build --workspace`.
*   Test `vespe-cli` (once created) by running `cargo run --package vespe-cli -- --help`.
*   Test `vespe-tui` by running `cargo run --package vespe-tui`.

**Approval:**
I await your approval before proceeding with this refactoring plan.
